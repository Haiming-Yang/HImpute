Sys.getenv('PATH')
install.packages("gislkit-master", repo=NULL, type="source")
cd
q()
q()
p = readRDS(C:\Users\intern\OneDrive\Study\GISL\scImpute-master)
p = readRDS(C:/Users/intern/OneDrive/Study/GISL/scImpute-master/paralist.rds)
p = readRDS("C:/Users/intern/OneDrive/Study/GISL/scImpute-master/paralist.rds")
p = readRDS("C:/Users/intern/OneDrive/Study/GISL/scImpute-master/parslist.rds")
View(p)
q()
setwd("C:\\Users\\intern\\OneDrive\\Study\\GISL\\Data\\impute\\ref39")
load("./ref39.RData")
load("./mi.RData")
load("./label.RData")
D <- log2(t + 1) # log transformation of count data
spm<-cor(x = t,method="spearman")
prn<-cor(x = t,method="pearson")
source('C:/Users/intern/OneDrive/Study/GISL/Data/impute/impute.R')
hi.t<-impute(Input,mi,spm,prn)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
library(Rtsne)
library(gislkit)
hi.t<-impute(Input,mi,spm,prn)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
Input <- t(D) # data matrix, cells in rows, genes in columns
hi.t<-impute(Input,mi,spm,prn)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.1,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.2,eta = 200)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
source('C:/Users/intern/OneDrive/Study/GISL/Data/impute/impute.R')
hi.t<-impute(Input,mi,spm,prn)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.2,eta = 200)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-40,40), xlim=c(-40,40),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-40,40), xlim=c(-40,40),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-40,40), xlim=c(-40,40),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-40,40), xlim=c(-40,40),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-40,40), xlim=c(-40,40),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
pca<-pcaMethods::pca(object = hi.t,nPcs = 2)
x<-pca$scores
pca$scores
names(pca)
setwd("C:\\Users\\intern\\OneDrive\\Study\\GISL\\Data\\impute\\ref39")
pca@scores
v<-pca@scores
View(v)
x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-40,40), xlim=c(-40,40),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,1000), xlim=c(-100,1000),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
library(DrImpute)
library(Rtsne)
library(gislkit)
scim<-t(read.csv("scimpute_count.csv",header = 1,row.names = 1))
drim<-DrImpute(t(Input))#gene by cell
drim<-t(drim)
a<-Rtsne(drim,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-100,100),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-40,40), xlim=c(-40,40),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-30,30), xlim=c(-20,20),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-30,30), xlim=c(-10,10),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-20,20), xlim=c(-10,10),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
pca<-pcaMethods::pca(object = drim,nPcs = 2)
x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-20,20), xlim=c(-10,10),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-200,200), xlim=c(-200,2000),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-200,200), xlim=c(-200,200),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
pca<-pcaMethods::pca(object = scim,nPcs = 2)
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-200,200), xlim=c(-200,200),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-200,200), xlim=c(-200,200),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
x<-a$Y
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-200,200), xlim=c(-200,200),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,
algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
View(res)
View(lb)
lb_num<-lb
n<-1
while(n<=622){
if(lb[n]==NP){
lb_num[n]=2
}
if(lb[n]==TH){
lb_num[n]=1
}
if(lb[n]==NF){
lb_num[n]=2
}
if(lb[n]==PEP){
lb_num[n]=4
}
}
lb_num<-lb
n<-1
while(n<=622){
if(lb[n]=="NP"){
lb_num[n]=2
}
if(lb[n]=="TH"){
lb_num[n]=1
}
if(lb[n]=="NF"){
lb_num[n]=2
}
if(lb[n]=="PEP"){
lb_num[n]=4
}
}
lb_num<-lb
n<-1
while(n<=622){
if(lb[n]=="NP"){
lb_num[n]=2
}
if(lb[n]=="TH"){
lb_num[n]=1
}
if(lb[n]=="NF"){
lb_num[n]=2
}
if(lb[n]=="PEP"){
lb_num[n]=4
}
n=n+1
}
View(lb_num)
lb_num<-as.numeric(lb_num)
lb_num<-as.matrix(lb_num)
View(lb_num)
lb_num<-lb
n<-1
while(n<=622){
if(lb[n]=="NP"){
lb_num[n]=2
}
if(lb[n]=="TH"){
lb_num[n]=1
}
if(lb[n]=="NF"){
lb_num[n]=3
}
if(lb[n]=="PEP"){
lb_num[n]=4
}
n=n+1
}
lb_num<-as.numeric(lb_num)
lb_num<-as.matrix(lb_num)
adj.rand.index(res, lb_num)
install.packages("fossil")
library(fossil)
adj.rand.index(res, lb_num)
rand.index(res, lb_num)
a<-Rtsne(Input,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,
+            algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(res, lb_num)
rand.index(res, lb_num)
a<-Rtsne(scim,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(res, lb_num)
rand.index(res, lb_num)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
#x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-200,200), xlim=c(-200,200),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
rand.index(res, lb_num)
adj.rand.index(res, lb_num)
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-100,100), xlim=c(-50,50),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-50,50), xlim=c(-50,50),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
spm<-cor(x = D,method="spearman")
prn<-cor(x = D,method="pearson")
hi.t<-impute(Input,mi,spm,prn)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
#x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-50,50), xlim=c(-50,50),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(res, lb_num)
rand.index(res, lb_num)
lb_num<-lb
n<-1
while(n<=622){
if(lb[n]=="NP"){
lb_num[n]=4
}
if(lb[n]=="TH"){
lb_num[n]=2
}
if(lb[n]=="NF"){
lb_num[n]=1
}
if(lb[n]=="PEP"){
lb_num[n]=3
}
n=n+1
}
lb_num<-as.numeric(lb_num)
lb_num<-as.matrix(lb_num)
rand.index(res, lb_num)
adj.rand.index(res, lb_num)
adj.rand.index(lb_num, lb_num)
adj.rand.index(lb_num, res)
lbum<-lb_num
lb_num<-lb
n<-1
while(n<=622){
if(lb[n]=="NP"){
lb_num[n]=3
}
if(lb[n]=="TH"){
lb_num[n]=4
}
if(lb[n]=="NF"){
lb_num[n]=2
}
if(lb[n]=="PEP"){
lb_num[n]=1
}
n=n+1
}
lb_num<-as.numeric(lb_num)
lb_num<-as.matrix(lb_num)
adj.rand.index(lb_num, lbum)
View(lbum)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
#x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-50,50), xlim=c(-50,50),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, lbum)
adj.rand.index(lb_num, res)
clu<-kmeans(x, 4, iter.max = 1000, nstart = 10,algorithm = "Lloyd", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
clu<-kmeans(x, 4, iter.max = 1000, nstart = 10,algorithm = "Forgy", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
x<-a$Y
clu<-kmeans(x, 4, iter.max = 1000, nstart = 10,algorithm = "Forgy", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
#x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-50,50), xlim=c(-50,50),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
#x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-50,50), xlim=c(-50,50),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
clu<-kmeans(x, 4, iter.max = 1000, nstart = 100,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
source('C:/Users/intern/OneDrive/Study/GISL/Data/impute/impute.R')
hi.t<-impute(Input,mi,spm,prn)
a<-Rtsne(hi.t,dims =2,initial_dims = 1000,max_iter = 10000,theta = 0.0,eta = 150)
x<-a$Y
#x<-pca@scores
plot(x[which(lb=="NP"),1], x[which(lb=="NP"),2], type="p",pch=21, bg = "salmon1", col= "salmon2", cex=1.7, xlab="tsne1", ylab="tsne2",ylim=c(-50,50), xlim=c(-50,50),  cex.lab=1.5, cex.axis=1.7, font.lab=2, bty='n')
points(x[which(lb=="NF"),1], x[which(lb=="NF"),2], type="p",pch=21, bg = "plum3", col = "plum4", cex=1.7)
points(x[which(lb=="TH"),1], x[which(lb=="TH"),2], type="p",pch=21, bg = "skyblue1", col= "skyblue2", cex=1.7)
points(x[which(lb=="PEP"),1], x[which(lb=="PEP"),2], type="p",pch=21, bg = "olivedrab2", col= "olivedrab3", cex=1.7)
temp <- legend("topright",  border = NULL,legend = c("NP","NF", "TH", "PEP"),
lty = c(0), pch=c(21,21,21,21), pt.bg=c("salmon1","plum3","skyblue1","olivedrab2"), xjust = 0, yjust = 0, bty = "n")
clu<-kmeans(x, 4, iter.max = 10, nstart = 10,algorithm = "Hartigan-Wong", trace=FALSE)
res<-clu$cluster
res<-as.matrix(res)
adj.rand.index(lb_num, res)
rand.index(lb_num, res)
foo <- som(Input, xdim=10, ydim=1)
library(som)
foo <- som(Input, xdim=10, ydim=1)
som1<-foo$visual$x
som1<-as.matrix(som1)
View(som1)
foo <- som(Input, xdim=4, ydim=1)
som1<-foo$visual$x
som1<-as.matrix(som1)
View(som1)
adj.rand.index(lb_num, som1)
foo <- som(drim, xdim=10, ydim=1)
foo <- som(drim, xdim=4, ydim=1)
som1<-foo$visual$x
som1<-as.matrix(som1)
adj.rand.index(lb_num, som1)
